<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mortgage Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-4 lg:p-8">
    <div class="max-w-7xl mx-auto">
        <h1 class="text-3xl font-bold text-center text-gray-800 mb-8">Interactive Mortgage Calculator</h1>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- Loan Details -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold text-gray-700 border-b-2 border-blue-500 pb-2 mb-4">Loan Details</h2>
                <div class="space-y-4">
                    <div>
                        <label for="homePrice" class="block text-sm font-medium text-gray-600 mb-1">Home Price ($)</label>
                        <input type="number" id="homePrice" value="509000" step="1000" class="w-full p-2 border border-gray-300 rounded-md focus:border-blue-500 focus:outline-none">
                    </div>
                    <div>
                        <label for="downPayment" class="block text-sm font-medium text-gray-600 mb-1">Down Payment ($)</label>
                        <input type="number" id="downPayment" value="101800" step="1000" class="w-full p-2 border border-gray-300 rounded-md focus:border-blue-500 focus:outline-none">
                    </div>
                    <div>
                        <label for="interestRate" class="block text-sm font-medium text-gray-600 mb-1">Interest Rate (%)</label>
                        <input type="number" id="interestRate" value="6.875" step="0.001" class="w-full p-2 border border-gray-300 rounded-md focus:border-blue-500 focus:outline-none">
                    </div>
                    <div>
                        <label for="loanTerm" class="block text-sm font-medium text-gray-600 mb-1">Loan Term (years)</label>
                        <input type="number" id="loanTerm" value="30" step="1" class="w-full p-2 border border-gray-300 rounded-md focus:border-blue-500 focus:outline-none">
                    </div>
                </div>
            </div>

            <!-- Monthly Payment Summary -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold text-gray-700 border-b-2 border-blue-500 pb-2 mb-4">Monthly Payment Breakdown</h2>
                <div class="bg-blue-50 p-4 rounded-lg mb-6">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-gray-700">Principal & Interest:</span>
                        <span id="principalInterest" class="font-medium">$2,675.01</span>
                    </div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-gray-700">Property Taxes:</span>
                        <span id="monthlyTaxes" class="font-medium">$654.58</span>
                    </div>
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-gray-700">Insurance:</span>
                        <span id="monthlyInsurance" class="font-medium">$150.00</span>
                    </div>
                    <div class="flex justify-between items-center pt-3 border-t-2 border-blue-500">
                        <span class="font-bold text-lg text-gray-800">Total Monthly Payment:</span>
                        <span id="totalPayment" class="font-bold text-lg text-blue-600">$3,479.59</span>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label for="propertyTaxRate" class="block text-sm font-medium text-gray-600 mb-1">Annual Property Tax Rate (%)</label>
                        <input type="number" id="propertyTaxRate" value="1.544" step="0.001" class="w-full p-2 border border-gray-300 rounded-md focus:border-blue-500 focus:outline-none">
                    </div>
                    <div>
                        <label for="annualInsurance" class="block text-sm font-medium text-gray-600 mb-1">Annual Insurance Premium ($)</label>
                        <input type="number" id="annualInsurance" value="1800" step="50" class="w-full p-2 border border-gray-300 rounded-md focus:border-blue-500 focus:outline-none">
                    </div>
                </div>
            </div>
        </div>

        <!-- Closing Costs & Cash to Close -->
        <div class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold text-gray-700 border-b-2 border-blue-500 pb-2 mb-6">Closing Costs & Cash to Close</h2>
            <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                <div class="space-y-6">
                    <!-- Closing Costs -->
                    <div>
                        <h3 class="text-lg font-medium text-gray-700 mb-4">Estimated Closing Costs</h3>
                        <div class="space-y-2 max-h-96 overflow-y-auto">
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Appraisal Fee</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="appraisal" value="560">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Credit Report Fee</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="creditReport" value="159">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Deed Recording</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="deedRecording" value="30">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Discount Points</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="discountPoints" value="4072">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Flood Certification Fee</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="floodCert" value="10.50">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Lender Doc Prep Fee</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="docPrep" value="40">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Lender's Title Insurance</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="titleInsurance" value="1843">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Loan Origination Fee</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="origination" value="700">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">MERS Fee</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="mers" value="24.95">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Mortgage Recording</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="mortgageRecording" value="30">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Owner's Title Insurance</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="ownerTitle" value="739">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Recording Release/Service Fee</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="recordingRelease" value="17">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Servicer Tax Service Fee</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="taxService" value="55">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Settlement/Closing Fee</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="settlement" value="250">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">State Transfer Taxes - Deed</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm closing-cost flex-shrink-0" data-field="transferTax" value="1527">
                            </div>
                            <div class="flex items-center py-3 pt-4 border-t-2 border-blue-500">
                                <span class="w-64 text-sm font-bold text-gray-800 flex-shrink-0 mr-4">Total Closing Costs</span>
                                <span class="w-24 text-right font-bold text-blue-600 bg-yellow-100 px-2 py-1 rounded" id="totalClosingCosts">$10,057.45</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="space-y-6">
                    <!-- Prepaid Expenses -->
                    <div>
                        <h3 class="text-lg font-medium text-gray-700 mb-4">Prepaid Expenses</h3>
                        <div class="space-y-2">
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Hazard Insurance Impounds</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm prepaid-cost flex-shrink-0" data-field="hazardImpounds" value="300">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Hazard Insurance Premium</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm prepaid-cost flex-shrink-0" data-field="hazardPremium" value="1800">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Prepaid Interest</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm prepaid-cost flex-shrink-0" data-field="prepaidInterest" value="460.20">
                            </div>
                            <div class="flex items-center py-2 border-b border-gray-100">
                                <span class="w-64 text-sm text-gray-700 flex-shrink-0 mr-4">Property Tax Impounds</span>
                                <input type="number" class="w-24 p-1 border border-gray-300 rounded text-right text-sm prepaid-cost flex-shrink-0" data-field="taxImpounds" value="1309.16">
                            </div>
                            <div class="flex items-center py-3 pt-4 border-t-2 border-blue-500">
                                <span class="w-64 text-sm font-bold text-gray-800 flex-shrink-0 mr-4">Total Prepaids</span>
                                <span class="w-24 text-right font-bold text-blue-600 bg-yellow-100 px-2 py-1 rounded" id="totalPrepaids">$3,869.36</span>
                            </div>
                        </div>
                    </div>

                    <!-- Cash to Close Summary -->
                    <div>
                        <h3 class="text-lg font-medium text-gray-700 mb-4">Cash to Close Summary</h3>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-gray-700">Down Payment:</span>
                                <span id="downPaymentDisplay" class="font-medium">$101,800.00</span>
                            </div>
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-gray-700">Closing Costs:</span>
                                <span id="closingCostsDisplay" class="font-medium">$10,057.45</span>
                            </div>
                            <div class="flex justify-between items-center mb-4">
                                <span class="text-gray-700">Prepaids:</span>
                                <span id="prepaidsDisplay" class="font-medium">$3,869.36</span>
                            </div>
                            <div class="flex justify-between items-center pt-3 border-t-2 border-blue-500">
                                <span class="font-bold text-lg text-gray-800">Total Cash to Close:</span>
                                <span id="totalCashToClose" class="font-bold text-lg text-blue-600">$114,199.82</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Calculate monthly mortgage payment
        function calculateMonthlyPayment(principal, rate, years) {
            const monthlyRate = rate / 100 / 12;
            const numPayments = years * 12;
            
            if (monthlyRate === 0) {
                return principal / numPayments;
            }
            
            return principal * (monthlyRate * Math.pow(1 + monthlyRate, numPayments)) / 
                   (Math.pow(1 + monthlyRate, numPayments) - 1);
        }

        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD'
            }).format(amount);
        }

        // Update all calculations
        function updateCalculations() {
            const homePrice = parseFloat(document.getElementById('homePrice').value) || 0;
            const downPayment = parseFloat(document.getElementById('downPayment').value) || 0;
            const interestRate = parseFloat(document.getElementById('interestRate').value) || 0;
            const loanTerm = parseFloat(document.getElementById('loanTerm').value) || 30;
            const propertyTaxRate = parseFloat(document.getElementById('propertyTaxRate').value) || 0;
            const annualInsurance = parseFloat(document.getElementById('annualInsurance').value) || 0;

            // Calculate loan amount
            const loanAmount = homePrice - downPayment;

            // Calculate monthly P&I
            const monthlyPI = calculateMonthlyPayment(loanAmount, interestRate, loanTerm);

            // Calculate monthly taxes and insurance
            const monthlyTaxes = (homePrice * propertyTaxRate / 100) / 12;
            const monthlyInsurance = annualInsurance / 12;

            // Update display
            document.getElementById('principalInterest').textContent = formatCurrency(monthlyPI);
            document.getElementById('monthlyTaxes').textContent = formatCurrency(monthlyTaxes);
            document.getElementById('monthlyInsurance').textContent = formatCurrency(monthlyInsurance);
            document.getElementById('totalPayment').textContent = formatCurrency(monthlyPI + monthlyTaxes + monthlyInsurance);

            // Update down payment display
            document.getElementById('downPaymentDisplay').textContent = formatCurrency(downPayment);

            // Calculate closing costs
            updateClosingCosts();
        }

        // Update closing costs
        function updateClosingCosts() {
            let totalClosingCosts = 0;
            let totalPrepaids = 0;

            // Sum closing costs
            document.querySelectorAll('.closing-cost').forEach(input => {
                totalClosingCosts += parseFloat(input.value) || 0;
            });

            // Sum prepaids
            document.querySelectorAll('.prepaid-cost').forEach(input => {
                totalPrepaids += parseFloat(input.value) || 0;
            });

            // Update displays
            document.getElementById('totalClosingCosts').textContent = formatCurrency(totalClosingCosts);
            document.getElementById('totalPrepaids').textContent = formatCurrency(totalPrepaids);
            document.getElementById('closingCostsDisplay').textContent = formatCurrency(totalClosingCosts);
            document.getElementById('prepaidsDisplay').textContent = formatCurrency(totalPrepaids);

            // Calculate total cash to close
            const downPayment = parseFloat(document.getElementById('downPayment').value) || 0;
            const totalCashToClose = downPayment + totalClosingCosts + totalPrepaids;
            document.getElementById('totalCashToClose').textContent = formatCurrency(totalCashToClose);
        }

        // Add event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Main loan inputs
            ['homePrice', 'downPayment', 'interestRate', 'loanTerm', 'propertyTaxRate', 'annualInsurance'].forEach(id => {
                document.getElementById(id).addEventListener('input', updateCalculations);
            });

            // Closing cost inputs
            document.querySelectorAll('.closing-cost, .prepaid-cost').forEach(input => {
                input.addEventListener('input', updateClosingCosts);
            });

            // Initial calculation
            updateCalculations();
        });
    </script>
</body>
</html>